/**
 * Несколько СЛОЖНЫХ тестов, проверяющих конвертирование 
 * десятичной дроби в формат с плавающей точкой IEEE-754
 * (Только числа одинарной и двойной точности)
 *
 * Караваев Артём Михайлович, http://zealcomputing.ru
 * 12.04.2015
 *
 */

#include <stdio.h>



// Структура для получения представления float как unsigned int
union {
  unsigned int asInt;
  float asFloat;
} f32;

// Структура для получения представления double как unsigned long long
union {
  unsigned long long asInt;
  double asFloat;
} f64;



// Тестирование числа одинарной точности
void test32 ( float a, unsigned int right, int testNumber ) {
  f32 . asFloat = a;
  if ( f32 . asInt != right )
    fprintf ( stderr, "Error on test %d: 0x%08x != 0x%08x\n", testNumber, f32 . asInt, right );
  else
    fprintf ( stderr, "Right on test %d\n", testNumber );
}

// Тестирование числа двойной точности
void test64 ( double a, unsigned long long right, int testNumber ) {
  f64 . asFloat = a;
  if ( f64 . asInt != right )
    fprintf ( stderr, "Error on test %d: 0x%016llx != 0x%016llx\n", testNumber, f64 . asInt, right );
  else
    fprintf ( stderr, "Right on test %d\n", testNumber );
}



// Список чисел одинарной точности и правильных двоичных представлений этих чисел
const int N32 = 0;

const float Test32 [ N32 ] = { 
};

const unsigned int Right32 [ N32 ] = { 
};



// Список чисел двойной точности и правильных двоичных представлений этих чисел
const int N64 = 9;

const double Test64 [ N64 ] = { 
  2.225073858507201383090232717332404064219215980462331830553327416887204434813918195854283159012511020564067339731035811005152434161553460108856012385377718821130777993532002330479610147442583636071921565046942503734208375250806650616658158948720491179968591639648500635908770118304874799780887753749949451580451605050915399856582470818645113537935804992115981085766051992433352114352390148795699609591288891602992641511063466313393663477586513029371762047325631781485664350872122828637642044846811407613911477062801689853244110024161447421618567166150540154285084716752901903161322778896729707373123334086988983175067838846926092773977972858659654941091369095406136467568702398678315290680984617210924625396728515625e-308,                                                               
  2.2250738585072018771558785585789482407880088486837041956131300312119688603996006965297904292212628858639037013670281908017171296072711910355127227413175152199055740043138804567803233377539881639177387328959246074229270113078053813397081653361296447449529789521218979090783852583365901851789618799885150427514782636076021680436220311292700454832073964845713103912225963935608322440623896907276890186717054549275173986589324810401738228328251245795065655738191038008646911615828719989708647293221449796971546706720399791990809160347625980385995424739847678861180095072511543762389603716215171729816011544604359531284325406441938645324905389137795680915804792405099227413854274942620542640408839836919187418172987793340279242767544565229087538682506419718265533447265625e-308,           
  2.225073858507202371221524399825492417356801716905076560672932645536733285985283197205297699430014751163740063003020570598281825052988921962169433097257311618680370015095758583081036528065392691763555900744906711111645647364804112062758171723538798309937366264595295182248000398368305570577036006227080633922504922164288936230661591439894977428478987977026639696679140794688312373772389232659678427752122018252042155806801495766953982188063736129641369100312575820243717972293621169304087413797478551780397864281278268544917722045363748655580517781818995617950934297749406849316597964346304638590078974833882923081797242441461636291003104968899481242069589385613709015202152589845793237400783350172912858237869043043055848553508913045817507736501283943653106689453125e-308,            
  2.22507385850720163012305563795567615250361241457301801308322872404958664760675944619203679411688695321398552054903200090343478188441232557218436756334761702051817599892294139362996674259828589999483014897143355557856769327930601597818316214242506796246078529588519927249357768832073249247992481686923224716596493432925878395010225097395757951057160073834364573849432419299709217920738991976169431413149717326525502008499797367678374315520581880443916381057236779117517775622749741380425338708447819365553307386742083452616251302946202273010905482006765402020154711200202813970014157525912344017736224427371246815175018974555997865323425588621961151633592416795802960447706494647018477736093430045142168360701364747951396213837722826145437693412532098591327667236328125e-308,          
  2.22507385850720163012305563795567615250361241457301801308322872404958664760675944619203679411688695321398552054903200090343478188441232557218436756334761702051817599892294139362996674259828589999483014897143355557856769327930601597818316214242506796246078529588519927249357768832073249247992481686923224716596493432925878395010225097395757951057160073834364573849432419299709217920738991976169431413149717326525502008499797367678374315520581880443916381057236779117517775622749741380425338708447819365553307386742083452616251302946202273010905482006765402020154711200202813970014157525912344017736224427371246815175018974555997865323425588621961151633592416795802960447706494647018477736093430045142168360701364747951396213837722826145437693412532098591327667236328124999e-308,       
  2.22507385850720163012305563795567615250361241457301801308322872404958664760675944619203679411688695321398552054903200090343478188441232557218436756334761702051817599892294139362996674259828589999483014897143355557856769327930601597818316214242506796246078529588519927249357768832073249247992481686923224716596493432925878395010225097395757951057160073834364573849432419299709217920738991976169431413149717326525502008499797367678374315520581880443916381057236779117517775622749741380425338708447819365553307386742083452616251302946202273010905482006765402020154711200202813970014157525912344017736224427371246815175018974555997865323425588621961151633592416795802960447706494647018477736093430045142168360701364747951396213837722826145437693412532098591327667236328125001e-308,       
  2.22507385850720212418870147920222032907240528279439037814303133837435107319244194686754406432563881851382188218502438069999947733013005649884107791928741341929297200970481951993067993290969042784064731682041565926728632933630474670123316852983422152744517260835859654566319282835244787787799894310779783833699159288594555213714181128458251145584319223079897504395086859412457230891738946169368372321191373658977977723286698840356390251044443035457396733706583981055420456693824658413747607155981176573877626747665912387199931904006317334709003012790188175203447190250028061277777916798391090578584006464715943810511489154282775041174682194133952466682503431306181587829379004205392375072083366693241580002758391118854188641513168478436313080237596295773983001708984374999e-308,       
  2.22507385850720212418870147920222032907240528279439037814303133837435107319244194686754406432563881851382188218502438069999947733013005649884107791928741341929297200970481951993067993290969042784064731682041565926728632933630474670123316852983422152744517260835859654566319282835244787787799894310779783833699159288594555213714181128458251145584319223079897504395086859412457230891738946169368372321191373658977977723286698840356390251044443035457396733706583981055420456693824658413747607155981176573877626747665912387199931904006317334709003012790188175203447190250028061277777916798391090578584006464715943810511489154282775041174682194133952466682503431306181587829379004205392375072083366693241580002758391118854188641513168478436313080237596295773983001708984375e-308,          
  2.22507385850720212418870147920222032907240528279439037814303133837435107319244194686754406432563881851382188218502438069999947733013005649884107791928741341929297200970481951993067993290969042784064731682041565926728632933630474670123316852983422152744517260835859654566319282835244787787799894310779783833699159288594555213714181128458251145584319223079897504395086859412457230891738946169368372321191373658977977723286698840356390251044443035457396733706583981055420456693824658413747607155981176573877626747665912387199931904006317334709003012790188175203447190250028061277777916798391090578584006464715943810511489154282775041174682194133952466682503431306181587829379004205392375072083366693241580002758391118854188641513168478436313080237596295773983001708984375001e-308       
};

const unsigned long long Right64 [ N64 ] = { 
  0x0010000000000000,
  0x0010000000000001,
  0x0010000000000002,
  0x0010000000000000,
  0x0010000000000000,
  0x0010000000000001,
  0x0010000000000001,
  0x0010000000000002,
  0x0010000000000002
};



int main ( ) {

  // Проверка всех чисел одинарной точности в цикле 
  /*
  fprintf ( stderr, "\n\n::: Single precision :::\n" );
  for ( int i = 0; i < N32; i ++ )
    test32 ( Test32 [ i ], Right32 [ i ], i );
  */

  // Проверка всех чисел двойной точности в цикле
  fprintf ( stderr, "\n::: Double precision :::\n" );
  for ( int i = 0; i < N64; i ++ )
    test64 ( Test64 [ i ], Right64 [ i ], i );

  return 0;
}
